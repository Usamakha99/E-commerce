<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FTP Products API Documentation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        h3 {
            color: #555;
            margin-top: 20px;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        pre {
            background-color: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px;
            margin: 15px 0;
        }
        .warning {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 10px;
            margin: 15px 0;
        }
        .success {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 10px;
            margin: 15px 0;
        }
        ul, ol {
            margin: 10px 0;
            padding-left: 30px;
        }
        @media print {
            body {
                max-width: 100%;
            }
            h1, h2 {
                page-break-after: avoid;
            }
        }
    </style>
</head>
<body>
    <h1>FTP Products API Documentation</h1>
    
    <h2>Table of Contents</h2>
    <ol>
        <li><a href="#authentication">Authentication</a></li>
        <li><a href="#ftp-products-api">FTP Products API</a></li>
        <li><a href="#error-handling">Error Handling</a></li>
        <li><a href="#rate-limiting">Rate Limiting</a></li>
        <li><a href="#examples">Examples</a></li>
    </ol>

    <h2 id="authentication">1. Authentication</h2>
    
    <h3>Login and Get Token</h3>
    <p>Authenticate with email and password to receive an API token. The token is required for all protected endpoints.</p>
    
    <p><strong>Endpoint:</strong> <code>POST /api/auth/login</code></p>
    <p><strong>Authentication:</strong> Not required (public endpoint)</p>
    
    <h4>Request Body:</h4>
    <pre>{
  "email": "user@example.com",
  "password": "password123"
}</pre>

    <h4>Success Response (201):</h4>
    <pre>{
  "success": true,
  "message": "Authentication successful",
  "token": "1|abcdefghijklmnopqrstuvwxyz1234567890...",
  "token_name": "API Token - 2025-01-27 10:30:00",
  "user": {
    "id": 1,
    "name": "John Doe",
    "email": "user@example.com"
  },
  "instructions": {
    "usage": "Include this token in the Authorization header as: Bearer 1|abcdefghijklmnop...",
    "example": "curl -H \"Authorization: Bearer YOUR_TOKEN\" http://your-domain.com/api/ftp-products"
  }
}</pre>

    <h4>Error Response (401):</h4>
    <pre>{
  "success": false,
  "error": "Invalid credentials",
  "message": "The provided email or password is incorrect"
}</pre>

    <div class="note">
        <strong>Important Notes:</strong>
        <ul>
            <li>When a new token is generated, all previous tokens for that user are automatically deleted</li>
            <li>Only one active token per user at a time</li>
            <li>Tokens do not expire by default (can be configured)</li>
            <li>MAC address authentication is skipped for API requests</li>
        </ul>
    </div>

    <h4>cURL Example:</h4>
    <pre>curl -X POST "https://test.vcloudtech.net/api/auth/login" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "password123"
  }'</pre>

    <h2 id="ftp-products-api">2. FTP Products API</h2>
    
    <h3>Get All Products</h3>
    <p>Retrieve a paginated list of products from all FTP distributor tables with optional search, sorting, and filtering.</p>
    
    <p><strong>Endpoint:</strong> <code>GET /api/ftp-products</code></p>
    <p><strong>Authentication:</strong> Required (Bearer token)</p>
    
    <h4>Query Parameters:</h4>
    <table>
        <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Required</th>
            <th>Default</th>
            <th>Description</th>
        </tr>
        <tr>
            <td><code>page</code></td>
            <td>integer</td>
            <td>No</td>
            <td>1</td>
            <td>Page number (min: 1)</td>
        </tr>
        <tr>
            <td><code>per_page</code></td>
            <td>integer</td>
            <td>No</td>
            <td>50</td>
            <td>Items per page (min: 1, max: 200)</td>
        </tr>
        <tr>
            <td><code>search</code></td>
            <td>string</td>
            <td>No</td>
            <td>-</td>
            <td>General search term (searches across: internal_sku, mfr_sku, vendor_name, description, upc)</td>
        </tr>
        <tr>
            <td><code>search_field</code></td>
            <td>string</td>
            <td>No</td>
            <td>-</td>
            <td>Specific field to search. Options: internal_sku, mfr_sku, vendor_name, description, upc</td>
        </tr>
        <tr>
            <td><code>search_value</code></td>
            <td>string</td>
            <td>Conditional</td>
            <td>-</td>
            <td>Required if search_field is provided. Value to search for in specified field</td>
        </tr>
        <tr>
            <td><code>sort_by</code></td>
            <td>string</td>
            <td>No</td>
            <td>id</td>
            <td>Field to sort by. Options: id, internal_sku, mfr_sku, vendor_name, description, msrp, cogs, weight, upc, stock, created_at, updated_at</td>
        </tr>
        <tr>
            <td><code>sort_direction</code></td>
            <td>string</td>
            <td>No</td>
            <td>asc</td>
            <td>Sort direction. Options: asc, desc</td>
        </tr>
        <tr>
            <td><code>distributor</code></td>
            <td>string/array</td>
            <td>No</td>
            <td>-</td>
            <td>Filter by distributor(s). Options: ingram, synnex, dnh, asi, arrow, scansource, 888voip, wholesale_house, or manual distributor names</td>
        </tr>
        <tr>
            <td><code>include_icecat</code></td>
            <td>string</td>
            <td>No</td>
            <td>false</td>
            <td>Include Icecat product data. Options: true, false, 1, 0. <strong>Note:</strong> Setting to true will significantly slow down the response</td>
        </tr>
    </table>

    <h4>Success Response (200):</h4>
    <pre>{
  "success": true,
  "data": [
    {
      "id": 123,
      "internal_sku": "SKU123",
      "mfr_sku": "MFR-SKU-123",
      "vendor_name": "DELL",
      "description": "Product description",
      "msrp": 99.99,
      "cogs": 75.00,
      "weight": 2.5,
      "upc": "123456789012",
      "stock": 100,
      "distributor": "Ingram",
      "table_name": "ingram_tech_ftps",
      "icecat": null,
      "created_at": "2025-01-27T10:00:00.000000Z",
      "updated_at": "2025-01-27T10:00:00.000000Z"
    }
  ],
  "meta": {
    "current_page": 1,
    "per_page": 10,
    "total": 2000,
    "last_page": 200,
    "from": 1,
    "to": 10
  },
  "filters": {
    "search": null,
    "search_field": null,
    "search_value": null,
    "sort_by": "id",
    "sort_direction": "asc",
    "distributors": null,
    "include_icecat": false
  }
}</pre>

    <h4>cURL Examples:</h4>
    
    <p><strong>1. Basic request - Get first 10 products:</strong></p>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products?page=1&per_page=10" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Accept: application/json"</pre>

    <p><strong>2. Search for products:</strong></p>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products?search=laptop&page=1&per_page=20" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Accept: application/json"</pre>

    <p><strong>3. Field-specific search:</strong></p>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products?search_field=mfr_sku&search_value=DELL-PN5122W" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Accept: application/json"</pre>

    <p><strong>4. Sort by price (ascending):</strong></p>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products?sort_by=msrp&sort_direction=asc&page=1&per_page=50" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Accept: application/json"</pre>

    <p><strong>5. Filter by distributor:</strong></p>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products?distributor=ingram&page=1&per_page=50" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Accept: application/json"</pre>

    <p><strong>6. Multiple distributors:</strong></p>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products?distributor[]=ingram&distributor[]=synnex&page=1" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Accept: application/json"</pre>

    <p><strong>7. With Icecat data (slower):</strong></p>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products?page=1&per_page=10&include_icecat=true" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Accept: application/json"</pre>

    <h3>Get Single Product by ID</h3>
    <p>Retrieve a single product by its ID.</p>
    
    <p><strong>Endpoint:</strong> <code>GET /api/ftp-products/{id}</code></p>
    <p><strong>Authentication:</strong> Required (Bearer token)</p>
    
    <h4>URL Parameters:</h4>
    <ul>
        <li><code>id</code> (integer, required) - Product ID</li>
    </ul>
    
    <h4>Query Parameters:</h4>
    <ul>
        <li><code>table_name</code> (string, optional) - Specify which table to search (if known)</li>
    </ul>

    <h4>Success Response (200):</h4>
    <pre>{
  "success": true,
  "data": {
    "id": 123,
    "internal_sku": "SKU123",
    "mfr_sku": "MFR-SKU-123",
    "vendor_name": "DELL",
    "description": "Product description",
    "msrp": 99.99,
    "cogs": 75.00,
    "weight": 2.5,
    "upc": "123456789012",
    "stock": 100,
    "distributor": "Ingram",
    "table_name": "ingram_tech_ftps",
    "icecat": {...},
    "created_at": "2025-01-27T10:00:00.000000Z",
    "updated_at": "2025-01-27T10:00:00.000000Z"
  }
}</pre>

    <h4>cURL Example:</h4>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products/123" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Accept: application/json"</pre>

    <h2 id="error-handling">3. Error Handling</h2>
    
    <h3>HTTP Status Codes</h3>
    <table>
        <tr>
            <th>Code</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>200</td>
            <td>Success</td>
        </tr>
        <tr>
            <td>201</td>
            <td>Created (token generated)</td>
        </tr>
        <tr>
            <td>400</td>
            <td>Bad Request (validation errors)</td>
        </tr>
        <tr>
            <td>401</td>
            <td>Unauthorized (invalid/missing token or credentials)</td>
        </tr>
        <tr>
            <td>403</td>
            <td>Forbidden (account disabled)</td>
        </tr>
        <tr>
            <td>404</td>
            <td>Not Found (product not found)</td>
        </tr>
        <tr>
            <td>500</td>
            <td>Internal Server Error</td>
        </tr>
    </table>

    <h3>Error Response Format</h3>
    <p>All error responses follow this format:</p>
    <pre>{
  "success": false,
  "error": "Error type",
  "message": "Human-readable error message",
  "errors": {
    "field_name": ["Validation error message"]
  }
}</pre>

    <h3>Common Error Scenarios</h3>
    
    <p><strong>1. Missing or Invalid Token:</strong></p>
    <pre>{
  "message": "Unauthenticated."
}</pre>

    <p><strong>2. Validation Error:</strong></p>
    <pre>{
  "success": false,
  "error": "Validation failed",
  "errors": {
    "per_page": ["The per page must not be greater than 200."],
    "search_field": ["The selected search field is invalid."]
  }
}</pre>

    <p><strong>3. Invalid Credentials:</strong></p>
    <pre>{
  "success": false,
  "error": "Invalid credentials",
  "message": "The provided email or password is incorrect"
}</pre>

    <h2 id="rate-limiting">4. Rate Limiting</h2>
    <p>API requests are subject to rate limiting to prevent abuse. If you exceed the rate limit, you will receive a 429 Too Many Requests response.</p>
    
    <h4>Rate Limit Response:</h4>
    <pre>{
  "message": "Too Many Attempts."
}</pre>

    <h2 id="examples">5. Complete Workflow Example</h2>
    
    <h3>Step 1: Get API Token</h3>
    <pre>curl -X POST "https://test.vcloudtech.net/api/auth/login" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "password123"
  }'</pre>

    <p><strong>Response:</strong></p>
    <pre>{
  "success": true,
  "token": "1|abcdefghijklmnop..."
}</pre>

    <h3>Step 2: Use Token to Get Products</h3>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products?page=1&per_page=10" \
  -H "Authorization: Bearer 1|abcdefghijklmnop..." \
  -H "Accept: application/json"</pre>

    <h3>Step 3: Search for Specific Products</h3>
    <pre>curl -X GET "https://test.vcloudtech.net/api/ftp-products?search=laptop&page=1&per_page=20" \
  -H "Authorization: Bearer 1|abcdefghijklmnop..." \
  -H "Accept: application/json"</pre>

    <h2>Base URL</h2>
    <p><strong>Development:</strong> <code>https://test.vcloudtech.net/api</code></p>
    <p><strong>Production:</strong> <code>https://your-domain.com/api</code></p>

    <h2>Support</h2>
    <p>For API support or questions, please contact your administrator.</p>

    <h2>Version</h2>
    <p>API Version: 1.0<br>
    Last Updated: January 27, 2025</p>

</body>
</html>
